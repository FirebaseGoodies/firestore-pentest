
<app-layout>
  <app-stepper [currentIndex]="1" [isLoading]="isLoading"></app-stepper>
  <nz-timeline [nzPending]="pendingTest?.description">
    <ng-container *ngFor="let test of tests">
      <nz-timeline-item
        *ngIf="test.status && test.status !== 'pending'"
        [nzColor]="test.status === 'success' ? 'green' : 'red'"
      >
        <span nz-tooltip [nzTooltipTitle]="durationTooltipTemplate" nzTooltipPlacement="right">
          {{ test.description }}
          <ng-template #durationTooltipTemplate>
            <i nz-icon nzType="clock-circle" class="mr-5"></i>
            <!-- <span>{{ (test.startDate | date:'HH:mm:ss') + ' -> ' + (test.endDate | date:'HH:mm:ss') }}</span> -->
            <span>{{ test.duration | duration }}</span>
          </ng-template>
        </span>
        <p *ngFor="let detail of test.results?.details" class="m-0 mt-7">
          <i nz-icon class="mr-5" [nzType]="detail.error ? 'close-circle' : 'check-circle'" [ngClass]="detail.error ? 'red-color' : 'green-color'"></i>
          <span nz-tooltip [nzTooltipTitle]="detail.error && errorTooltipTemplate" nzTooltipPlacement="right">
            {{ detail.description }}
            <ng-template #errorTooltipTemplate>
              <i nz-icon nzType="warning" class="mr-5"></i>
              <span>{{ detail.error }}</span>
            </ng-template>
          </span>
        </p>
      </nz-timeline-item>
    </ng-container>
  </nz-timeline>
  <div class="align-center">
    <button nz-button nzType="default" nzSize="large" nzShape="round" class="rescan-button" [disabled]="isLoading" (click)="rescan()">
      Rescan<i nz-icon nzType="reload"></i>
    </button>
  </div>
</app-layout>
